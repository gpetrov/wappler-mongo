<!-- Wappler include head-page="layouts/app" jquery_slim_33="cdn" fontawesome_4="cdn" bootstrap4="local" is="dmx-app" id="app" appconnect="local" components="{dmxBootstrap4TableGenerator:{},dmxBootstrap4Modal:{},dmxFormatter:{},dmxBootbox:{},dmxDatastore:{}}" -->
<dmx-value id="delid" dmx-bind:value="'none'"></dmx-value>
<dmx-api-action id="api_user_delete" noload="true" url="/api/Security/userdelete" data-type="json" dmx-param:token="user.data.jwt" dmx-param:deleteid="'none'"></dmx-api-action>
<dmx-value id="formstate" dmx-bind:value="'edit'"></dmx-value>
<!-- Wappler include head-page="layouts/app" jquery_slim_33="cdn" fontawesome_4="cdn" bootstrap4="local" is="dmx-app" id="app. appconnect="local" components="{dmxBootstrap4TableGenerator:{},dmxBootstrap4Modal:{}}" -->

<div class="modal" id="modal-warning" is="dmx-bs4-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <p class="text-center text-warning"><i class="fas fa-exclamation-circle fa-6x"></i></p>
                <h4 class="text-center font-weight-light">Are you sure you want to delete this user?</h4>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" data-toggle="modal" data-target="#modal-warning">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="modal_edit_user" is="dmx-bs4-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form_update_user" is="dmx-api-form" action="/api/Security/userupdate" method="post" post-data="json" dmx-on:start="preloader1.show()" dmx-on:done="preloader1.hide()" dmx-param:token="user.data.jwt">
                    <input id="_id" name="_id" type="text" class="form-control">
                    <div class="form-group">
                        <label for="firstname">First Name</label>
                        <input type="text" class="form-control" id="firstname" name="firstname" aria-describedby="input1_help" placeholder="John">
                    </div>
                    <div class="form-group">
                        <label for="lastname">Last Name</label>
                        <input type="text" class="form-control" id="lastname" name="lastname" aria-describedby="input1_help" placeholder="Da Revelator">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="text" class="form-control" id="email" name="email" aria-describedby="input1_help" placeholder="john@darevelator.live">
                    </div>
                    <div class="form-group">
                        <label for="mobile">Mobile Number</label>
                        <input type="text" class="form-control" id="mobile" name="mobile" aria-describedby="input1_help" placeholder="0792111111111">
                    </div>
                    <div class="form-group">
                        <label for="active2">Status</label>
                        <select id="userstate" class="form-control" name="userstate">
                            <option value="Not Approved">Not Approved</option>
                            <option value="Approved">Approved</option>
                            <option value="Suspended">Suspended</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="role">Privileges</label>
                        <select id="role" class="form-control" name="role">
                            <option value="User">User</option>
                            <option value="Lecturer">Lecturer</option>
                            <option value="Admin">Admin</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" dmx-on:click="modal_edit_user.form_update_user.submit()">Save changes</button>
            </div>
        </div>
    </div>
</div>
<dmx-api-datasource id="api1" is="dmx-fetch" url="/api/Security/getusers" dmx-param:token="user.data.jwt" dmx-on:start="preloader1.show()" dmx-on:done="preloader1.hide()"></dmx-api-datasource>
<meta name="ac:route" content="/users">
<div class="container-fluid">
    <div class="row">
        <div class="col">
            <div class="table-responsive">
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th scope="row">Action</th>
                            <th>Firstname</th>
                            <th>Lastname</th>
                            <th>Email</th>
                            <th>Mobile</th>
                            <th>Organisation</th>
                            <th>State</th>
                            <th>Role</th>
                        </tr>
                    </thead>
                    <tbody is="dmx-repeat" dmx-generator="bs4table" dmx-bind:repeat="api1.data" id="tableRepeat1">
                        <tr>
                            <td>
                                <a href="" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#modal_edit_user"
                                    dmx-on:click="modal_edit_user.form_update_user.firstname.setValue(firstname);modal_edit_user.form_update_user.lastname.setValue(lastname);modal_edit_user.form_update_user.userstate.setValue(userstate);modal_edit_user.form_update_user.role.setValue(role);modal_edit_user.form_update_user.email.setValue(email);modal_edit_user.form_update_user.mobile.setValue(mobile);modal_edit_user.form_update_user._id.setValue(_id);formstate.setValue('edit')"><i
                                        class="fa fa-pencil"></i>
                                </a>
                            </td>
                            <td dmx-text="firstname"></td>
                            <td dmx-text="lastname"></td>
                            <td dmx-text="email"></td>
                            <td dmx-text="mobile"></td>
                            <td dmx-text="organisation"></td>
                            <td dmx-text="userstate"></td>
                            <td dmx-text="role"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>